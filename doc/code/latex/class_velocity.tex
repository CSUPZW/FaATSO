\hypertarget{class_velocity}{}\section{Velocity Class Reference}
\label{class_velocity}\index{Velocity@{Velocity}}


the class \hyperlink{class_velocity}{Velocity} corresponds to an anisotropic seismic velocity model, characterised by two independent parameters.  




{\ttfamily \#include $<$velocitylib.\+hpp$>$}

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{class_velocity_ad12087bb64c45d3f321cd4c8d5196c31}{Velocity} (const double \&, const double \&)
\begin{DoxyCompactList}\small\item\em class constructor \end{DoxyCompactList}\item 
\hypertarget{class_velocity_a852088c8d4dbb7e1beb0d793a57e9d11}{}\hyperlink{class_velocity_a852088c8d4dbb7e1beb0d793a57e9d11}{Velocity} ()\label{class_velocity_a852088c8d4dbb7e1beb0d793a57e9d11}

\begin{DoxyCompactList}\small\item\em default class constructor \end{DoxyCompactList}\item 
double \hyperlink{class_velocity_a51559f5012552c6d229628b231cafb56}{Vphase} (const double \&)
\begin{DoxyCompactList}\small\item\em method to compute the phase velocity \end{DoxyCompactList}\item 
double \hyperlink{class_velocity_ac11aa4675b1bb47ffc911bcac33e87b3}{tan\+\_\+group\+\_\+angle} (const double \&)
\begin{DoxyCompactList}\small\item\em method to compute the tangent of the group angle from the tangent of the phase angle \end{DoxyCompactList}\item 
double \hyperlink{class_velocity_a777312f53b67be665c6f0531baf9c9d8}{group\+\_\+angle} (const double \&)
\begin{DoxyCompactList}\small\item\em method to compute the group angle from the phase angle \end{DoxyCompactList}\item 
double \hyperlink{class_velocity_a5d0a3d765fc69ce7f5fb0baa76c8e862}{phase\+\_\+angle} (const double \&)
\begin{DoxyCompactList}\small\item\em method to compute the phase angle from the group angle \end{DoxyCompactList}\item 
double \hyperlink{class_velocity_ab81f09120d5e499952bb9e6d642e9695}{Vgroup} (const double \&)
\begin{DoxyCompactList}\small\item\em method to compute the group velocity \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hypertarget{class_velocity_aa9ec620040da2f62dd7c2bc7d69c9b81}{}double \hyperlink{class_velocity_aa9ec620040da2f62dd7c2bc7d69c9b81}{vh}\label{class_velocity_aa9ec620040da2f62dd7c2bc7d69c9b81}

\begin{DoxyCompactList}\small\item\em the horizontal wavespeed \end{DoxyCompactList}\item 
\hypertarget{class_velocity_aee17394cc59d107985e891ae356dcb0a}{}double \hyperlink{class_velocity_aee17394cc59d107985e891ae356dcb0a}{E}\label{class_velocity_aee17394cc59d107985e891ae356dcb0a}

\begin{DoxyCompactList}\small\item\em the aniostropy parameter, such that the vertical wavespeed is equal to vh$\ast$(1+\+E) \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
the class \hyperlink{class_velocity}{Velocity} corresponds to an anisotropic seismic velocity model, characterised by two independent parameters. 

the model is very simple, and is more phenomenological than purely physical. the model is for transversely isotropic medium, and the phase velocity is elliptical\+: $v(\theta) = v_\mathrm{h}(1 + E \cos^2(\theta))$ where $\theta$ is the phase angle, $v_\mathrm{h}$ is the horizontal wavespeed, and $E$ is the anisotropy parameter. 

\subsection{Constructor \& Destructor Documentation}
\hypertarget{class_velocity_ad12087bb64c45d3f321cd4c8d5196c31}{}\index{Velocity@{Velocity}!Velocity@{Velocity}}
\index{Velocity@{Velocity}!Velocity@{Velocity}}
\subsubsection[{Velocity(const double \&, const double \&)}]{\setlength{\rightskip}{0pt plus 5cm}Velocity\+::\+Velocity (
\begin{DoxyParamCaption}
\item[{const double \&}]{v, }
\item[{const double \&}]{e}
\end{DoxyParamCaption}
)}\label{class_velocity_ad12087bb64c45d3f321cd4c8d5196c31}


class constructor 


\begin{DoxyParams}{Parameters}
{\em v} & the horizontal wavespeed \\
\hline
{\em e} & the anisotropy parameter \\
\hline
\end{DoxyParams}


\subsection{Member Function Documentation}
\hypertarget{class_velocity_a777312f53b67be665c6f0531baf9c9d8}{}\index{Velocity@{Velocity}!group\+\_\+angle@{group\+\_\+angle}}
\index{group\+\_\+angle@{group\+\_\+angle}!Velocity@{Velocity}}
\subsubsection[{group\+\_\+angle(const double \&)}]{\setlength{\rightskip}{0pt plus 5cm}double Velocity\+::group\+\_\+angle (
\begin{DoxyParamCaption}
\item[{const double \&}]{theta}
\end{DoxyParamCaption}
)}\label{class_velocity_a777312f53b67be665c6f0531baf9c9d8}


method to compute the group angle from the phase angle 


\begin{DoxyParams}{Parameters}
{\em theta} & the phase angle \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the group angle 
\end{DoxyReturn}
\hypertarget{class_velocity_a5d0a3d765fc69ce7f5fb0baa76c8e862}{}\index{Velocity@{Velocity}!phase\+\_\+angle@{phase\+\_\+angle}}
\index{phase\+\_\+angle@{phase\+\_\+angle}!Velocity@{Velocity}}
\subsubsection[{phase\+\_\+angle(const double \&)}]{\setlength{\rightskip}{0pt plus 5cm}double Velocity\+::phase\+\_\+angle (
\begin{DoxyParamCaption}
\item[{const double \&}]{phi}
\end{DoxyParamCaption}
)}\label{class_velocity_a5d0a3d765fc69ce7f5fb0baa76c8e862}


method to compute the phase angle from the group angle 

There is no analytical formula to do the conversion, so a numerical approach is used. For simplicity and robustness I use Ridders\textquotesingle{} method. Important to note is that the input group angle $\phi$ is larger than $\pi/2$, a situation unphysical in principle but often met in real life because of the floating-\/point nature of the computation, this function will assume that $\phi=\pi/2$. Same thing for $\phi<-\pi/2$. 
\begin{DoxyParams}{Parameters}
{\em phi} & the group angle \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the phase angle 
\end{DoxyReturn}
\hypertarget{class_velocity_ac11aa4675b1bb47ffc911bcac33e87b3}{}\index{Velocity@{Velocity}!tan\+\_\+group\+\_\+angle@{tan\+\_\+group\+\_\+angle}}
\index{tan\+\_\+group\+\_\+angle@{tan\+\_\+group\+\_\+angle}!Velocity@{Velocity}}
\subsubsection[{tan\+\_\+group\+\_\+angle(const double \&)}]{\setlength{\rightskip}{0pt plus 5cm}double Velocity\+::tan\+\_\+group\+\_\+angle (
\begin{DoxyParamCaption}
\item[{const double \&}]{tan\+\_\+theta}
\end{DoxyParamCaption}
)}\label{class_velocity_ac11aa4675b1bb47ffc911bcac33e87b3}


method to compute the tangent of the group angle from the tangent of the phase angle 


\begin{DoxyParams}{Parameters}
{\em tan\+\_\+theta} & the tangent of the phase angle \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the tangent of the group angle 
\end{DoxyReturn}
\hypertarget{class_velocity_ab81f09120d5e499952bb9e6d642e9695}{}\index{Velocity@{Velocity}!Vgroup@{Vgroup}}
\index{Vgroup@{Vgroup}!Velocity@{Velocity}}
\subsubsection[{Vgroup(const double \&)}]{\setlength{\rightskip}{0pt plus 5cm}double Velocity\+::\+Vgroup (
\begin{DoxyParamCaption}
\item[{const double \&}]{phi}
\end{DoxyParamCaption}
)}\label{class_velocity_ab81f09120d5e499952bb9e6d642e9695}


method to compute the group velocity 


\begin{DoxyParams}{Parameters}
{\em phi} & the group angle \\
\hline
\end{DoxyParams}
\hypertarget{class_velocity_a51559f5012552c6d229628b231cafb56}{}\index{Velocity@{Velocity}!Vphase@{Vphase}}
\index{Vphase@{Vphase}!Velocity@{Velocity}}
\subsubsection[{Vphase(const double \&)}]{\setlength{\rightskip}{0pt plus 5cm}double Velocity\+::\+Vphase (
\begin{DoxyParamCaption}
\item[{const double \&}]{theta}
\end{DoxyParamCaption}
)}\label{class_velocity_a51559f5012552c6d229628b231cafb56}


method to compute the phase velocity 


\begin{DoxyParams}{Parameters}
{\em theta} & the phase angle \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the phase velocity 
\end{DoxyReturn}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/\+Volumes/\+Data/\+Projects/\+Tomography/\+Faatso/include/velocitylib.\+hpp\item 
/\+Volumes/\+Data/\+Projects/\+Tomography/\+Faatso/src/velocitylib.\+cpp\end{DoxyCompactItemize}
